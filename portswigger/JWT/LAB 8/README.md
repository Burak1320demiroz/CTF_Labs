# LAB 8 (JWT authentication bypass via algorithm confusion with no exposed key)

Bu labda, JWT tabanlı oturum mekanizması RSA anahtarıyla imzalanıyor ancak algoritma karışıklığı zafiyetinden dolayı bu yapı atlatılabiliyor. İlk olarak, kendi hesabınla iki farklı JWT token alıyorsun; biriyle giriş yapıp çıkış yaparak ikinci tokenı da elde ediyorsun. Ardından, bu iki tokenı kullanarak terminalde verilen `sig2n` aracını çalıştırıyorsun. Bu araç, sunucunun RSA modülünü brute-force yöntemiyle hesaplayıp birden fazla olası public key ve ona karşılık gelen bozuk JWT’ler üretiyor. Doğru public key’i bulmak için bu tokenları teker teker deneyip geçerli olanı tespit ediyorsun. Daha sonra Burp Suite’te JWT Editor ile yeni bir symmetric key oluşturuyor, bu key’in `k` değerini bulduğun public key’in Base64 kodlanmış hali ile değiştiriyorsun. Son olarak, `/admin` isteğindeki JWT header’da algoritmayı `HS256` olarak değiştirip payload’da `sub` alanını `administrator` yapıyor, yeni symmetric key ile tokenı imzalayıp isteği gönderiyorsun. Böylece admin paneline erişip Carlos kullanıcısını silebiliyorsun.
